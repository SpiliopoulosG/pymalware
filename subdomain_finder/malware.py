import requests
from termcolor import colored
import argparse

def get_arguments():
    parser = argparse.ArgumentParser(description="Network Scanner")
    parser.add_argument("-u", "--url", type=str, help="Url to discover directories", required=True)
    parser.add_argument("-f", "--file", type=str, help="File with directories", required=True)
    args = parser.parse_args()
    return args

def request(url):
    try:
        return requests.get(url = "http://" + url, timeout= 1)
    except requests.exceptions.ConnectionError:
        pass
    except requests.exceptions.Timeout:
        pass

def scan_subdomain(url):
    file = open(args.file, 'r')
    for line in file:
        subdomain = line.strip()
        subdomain = subdomain.strip(".")
        subdomain = subdomain.strip("*")
        full_url = subdomain + "." + url
        response = request(full_url)
        if response:
            print(colored("[+] Discovered Subdomain %s" % full_url, 'green'))

args = get_arguments()
scan_subdomain(args.url)
